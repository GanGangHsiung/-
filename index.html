<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°åº—é¡å®¶ - çµ‚æ¥µéˆé­‚æ¨¡æ“¬å™¨</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #84a1c1; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        #setup { background: white; padding: 30px; border-radius: 15px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.2); width: 320px; }
        #chat-container { display: none; width: 100%; max-width: 500px; height: 100vh; background: #84a1c1; flex-direction: column; }
        #status-bar { background: rgba(0,0,0,0.15); padding: 12px 15px; font-size: 13px; color: white; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); }
        #messages { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; scroll-behavior: smooth; }
        .msg { margin-bottom: 12px; padding: 10px 14px; border-radius: 18px; font-size: 14.5px; line-height: 1.5; max-width: 80%; position: relative; word-wrap: break-word; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .msg.bot { background: white; align-self: flex-start; border-top-left-radius: 2px; }
        .msg.user { background: #95ec69; align-self: flex-end; border-top-right-radius: 2px; }
        .name { font-size: 11px; color: #555; margin-bottom: 4px; font-weight: bold; }
        .input-box { background: #fff; padding: 15px; display: flex; gap: 10px; border-top: 1px solid #ddd; }
        input { flex: 1; border: 1px solid #ddd; border-radius: 25px; padding: 12px 18px; outline: none; font-size: 15px; }
        button { background: #00c300; color: white; border: none; padding: 0 22px; border-radius: 25px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div id="setup">
    <h2>æ–°åº—é¡å®¶ æ¨¡æ“¬å™¨</h2>
    <p style="font-size: 14px; color: #666;">å„ªåŒ–å…§å®¹ï¼šæ·±åº¦ç´€éŒ„æå– + é€£é–äº’å™´</p>
    <select id="mode" style="width: 100%; padding: 10px; margin-bottom: 20px;">
        <option value="group">ğŸ”Š å…¨é«”ç¾¤çµ„ (ç˜‹ç‹‚åµæ¶)</option>
        <option value="single_ç†Šå‰›å‰›Jimmy">å–®èŠï¼šç†Šå‰›å‰›Jimmy</option>
        <option value="single_ç‹æ°´æº">å–®èŠï¼šç‹æ°´æº</option>
        <option value="single_é»ƒå­åº­ Troy">å–®èŠï¼šé»ƒå­åº­ Troy</option>
        <option value="single_Gee Homie">å–®æŒ‘ï¼šGee Homie</option>
    </select>
    <button onclick="initChat()" style="width: 100%; padding: 12px;">é€²å…¥èŠå¤©</button>
</div>

<div id="chat-container">
    <div id="status-bar" id="typing-status">æ–°åº—é¡å®¶ (4)</div>
    <div id="messages"></div>
    <div class="input-box">
        <input type="text" id="userInput" placeholder="è¼¸å…¥ï¼šæ©Ÿç¥¨ã€å˜‰æ©ã€æ—ºå®ã€å¸¥..." onkeypress="if(event.keyCode==13) doSend()">
        <button onclick="doSend()">å‚³é€</button>
    </div>
</div>

<script>
const friends = {
    "ç†Šå‰›å‰›Jimmy": {
        fallbacks: ["ç¬‘æ­»", "å°Šéƒ½å‡å˜Ÿ", "æˆ‘ä¸ä¿¡", "åˆ°åº•", "å¥½æ‰¯", "ç¬‘ç ´"],
        keywords: { 
            "åˆ†æ‰‹": "é¢¨éšªå°æ²–åŠ æ§“æ¡¿çš„æ¦‚å¿µï¼ŒçœŸçš„å»ºè­°åˆ†ä¸€åˆ†ï¼Œæ­¢æå•Šå¤§å“¥", 
            "å¤§ç‰Œ": "æˆ‘ä¹Ÿæ˜¯å¯ä»¥è€å¤§ç‰Œç›´æ¥èµ°äººå•¦ï¼Œç¸½ç¶“ç†å¯ä»¥æ²’ç‰¹åŠ©ï¼Œä½†æˆ‘ä¸èƒ½æ²’ç“œåƒ",
            "æ©Ÿç¥¨": "å¸¶å››å·åª³å©¦éƒ½ä¸ç”¨ä¸€ç›´æ”¹æ©Ÿç¥¨ï¼Œçœå¤šå°‘éŒ¢ï¼Œå¦³å€‘çœŸçš„è´äº†",
            "å˜‰æ©": "ç¬‘æ­»ï¼Œæ°´æºåˆè¦é–‹å§‹ç—›è‹¦äº†ï¼Œåˆ°åº•æ˜¯è¦èŠå¹¾æ¬¡ @ç‹æ°´æº",
            "ç¡": "å¤§åŠå¤œä¸ç¡è¦ºåœ¨é€™é‚Šåµï¼Œæ˜å¤©ä¸ç”¨ä¸Šç­ï¼Ÿ"
        },
        topics: ["ç¬‘æ­»ï¼Œä½ å€‘çœ‹é€™å€‹", "å˜¿å˜¿ï¼Œæ°´æºåˆè¦å˜‰æ©äº†", "é»ƒå­åº­æ˜¯ä¸æ˜¯åœ¨ç™¼ç˜‹", "åˆ°åº•åœ¨ç¬‘ä»€éº¼å•¦"]
    },
    "ç‹æ°´æº": {
        fallbacks: ["å‡è³½å•¦", "å¹¹ä½ å¨˜æœƒè¢«ä½ å€‘å®³æ­»", "ç„¡è¨€", "å¥½ç—›è‹¦", "éä¾† åä¸‹"],
        keywords: { 
            "å˜‰æ©": "æˆ‘å…ˆä¿®ç†å¥¹ï¼Œåª½çš„æƒ³æ‰¾å€‹æ­£å¸¸äººäº¤å¾€å¥½é›£ï¼Œæˆ‘é‚„æ˜¯æƒ³è·Ÿå¥¹å»æ±äº¬", 
            "éŒ¢": "æ”¶ä¸€ä¸‹è¿ªå£«å°¼é–€ç¥¨éŒ¢ï¼Œç‚ºäº†æˆ‘çš„éŒ¢åŒ…è¬è¬å¤§å®¶", 
            "è‚¡ç¥¨": "æ—ºå®äº®ç‡ˆå…©å¤©äº†ï¼Œæœ‰äººé‚„åœ¨è»Šä¸Šå—ï¼Ÿçˆ›è²¨ï¼Œä¸ç„¶è™§æ›´å¤šï¼ï¼",
            "å¸¥": "ä½ é•·å¾—å¾ˆåƒä¸­åœ‹å¹¹ç‰‡è£¡çš„éœ¸é“ç¸½è£ï¼Œåˆé«˜åˆå¸¥å…¨èº«é»‘ï¼Œé¡§åŒ—è¾°",
            "é¡§åŒ—è¾°": "é¡§åŒ—è¾°å°±æ˜¯é‚£å€‹æŠ–éŸ³å½±ç‰‡ï¼Œéä¾†ï¼Œåä¸‹",
            "ä¿®ç†": "ç”¨å±Œä¿®ç†ï¼Œç›¸ä¿¡æˆ‘ï¼Œæˆ‘ç¾åœ¨åšå¾—åˆ° @é»ƒå­åº­ Troy"
        },
        topics: ["æˆ‘å¥½ç—›è‹¦", "å˜‰æ©é€™å¥³äººçœŸçš„æ²’æ•‘", "æ—ºå®äº®ç‡ˆå…©å¤©äº†", "é¡§åŒ—è¾°ï¼Œåˆé«˜åˆå¸¥å…¨èº«é»‘"]
    },
    "é»ƒå­åº­ Troy": {
        fallbacks: ["ç™½ç™¡å–”", "æ“ä½ åª½", "å°ç¡¬", "Fuckable", "ç…©éƒ½ç…©æ­»", "ä¸‰æ¢ç´°ç‹—"],
        keywords: { 
            "æ©Ÿç¥¨": "æ”¹ä¾†æ”¹å»æ“ä»–åª½ï¼Œæµªè²»æˆ‘å¤šå°‘éŒ¢ï¼Œ18å¹´å¥¹å€‘è´äº†", 
            "æ€’": "å¦‚æœä½ æ˜¯æƒ³æ¿€æ€’æˆ‘ï¼Œæ­å–œä½ ï¼Œä½ æˆåŠŸäº†",
            "å—å‹¢è§’": "å¤§å®¶æ˜å¤©å—å‹¢è§’é›†åˆï¼Œä¸å‡†è€å¤§ç‰Œ @ç†Šå‰›å‰›Jimmy",
            "å±€å¤–äºº": "ç‚ºä»€éº¼åªæœ‰æˆ‘æ˜¯å±€å¤–äººï¼Ÿæˆ‘è·Ÿå¥¹å‡ºä¾†æ²’ä»¥å‰é–‹å¿ƒäº†",
            "å¤§é™¸": "æˆ‘é©åˆå»ä¸­åœ‹ç™¼å±•å—ï¼Ÿå¤§é™¸äººè³‡æ–™ç®¡å®¶æ‹¿ä¾†æ²’ @Gee Homie"
        },
        topics: ["ç™½ç™¡å–”", "ç‚ºä»€éº¼åªæœ‰æˆ‘æ˜¯å±€å¤–äºº", "æ“ä½ åª½æ©Ÿç¥¨æ”¹ä¾†æ”¹å»", "ä½ å€‘é€™ç¾¤ç´°ç‹—"]
    },
    "Gee Homie": {
        fallbacks: ["æ„›äº†", "ä¸æ„›äº†", "ä¸‰å°å•¦", "è¡Œ", "ç¬‘æ­»", "çœŸÂ·ä¹¾çˆ¹"],
        keywords: { 
            "ç´„": "æ˜å¤©æ™šä¸Šé›†åˆï¼Œå¹¾é»åˆ°å³èˆˆè¡—ï¼Ÿæ…¢ä¾†åƒæ±è¥¿ä¸æªï¼Ÿ", 
            "è³‡æ–™": "ç®¡å®¶ï¼Œä¸‰åˆ†é˜ä¹‹å…§æˆ‘è¦å¨¶å¤§é™¸äººå…¨éƒ¨çš„è³‡æ–™ @ç‹æ°´æº",
            "é£è¿”": "å¥½æ…˜æœƒè¢«é£è¿”ï¼ŒçœŸçš„æ„›äº†",
            "é€šçŸ¥": "é€™æ˜¯é€šçŸ¥ä¸æ˜¯å•†é‡ï¼Œæ‡‚ï¼Ÿ",
            "æ¼¢å ¡": "æˆ‘é¸äº†é€™é–“æ¼¢å ¡ï¼Œæˆ‘çˆ¸å–œæ­¡åƒ"
        },
        topics: ["ä¸‰å°å•¦", "è¡Œ", "é€™æ˜¯é€šçŸ¥ä¸æ˜¯å•†é‡", "ç®¡å®¶ï¼Œä¸‰åˆ†é˜ä¹‹å…§..."]
    }
};

let config = { mode: 'group', target: null };
let autoTimer = null;

function initChat() {
    const val = document.getElementById('mode').value;
    config.mode = val === 'group' ? 'group' : 'single';
    if(config.mode === 'single') config.target = val.replace('single_', '');
    document.getElementById('setup').style.display = 'none';
    document.getElementById('chat-container').style.display = 'flex';
    addMsg("ç³»çµ±", "é€£ç·šæˆåŠŸã€‚ç´ æåº«å·²æ›´æ–°ï¼Œé«˜é »é€£é–æ¨¡å¼å•Ÿå‹•ã€‚", "bot");
    if(config.mode === 'group') resetAutoTimer();
}

function scanForReaction(sender, text) {
    if (config.mode !== 'group') return;
    const names = Object.keys(friends).filter(n => n !== sender).sort(() => Math.random() - 0.5);

    for (let name of names) {
        for (let key in friends[name].keywords) {
            if (text.includes(key) || text.includes(`@${name}`)) {
                if (Math.random() < 0.95) {
                    setTimeout(() => {
                        addMsg(name, friends[name].keywords[key] || friends[name].fallbacks[0], "bot");
                    }, 500 + Math.floor(Math.random() * 800));
                }
                return;
            }
        }
    }
    // éš¨æ©Ÿåæ§½æ©Ÿç‡
    if (Math.random() < 0.25) {
        setTimeout(() => {
            const rName = names[Math.floor(Math.random() * names.length)];
            addMsg(rName, friends[rName].fallbacks[Math.floor(Math.random() * friends[rName].fallbacks.length)], "bot");
        }, 1500);
    }
}

function resetAutoTimer() {
    if(autoTimer) clearTimeout(autoTimer);
    const nextInterval = 3000 + Math.floor(Math.random() * 5000);
    autoTimer = setTimeout(() => {
        if(config.mode === 'group') {
            const name = Object.keys(friends)[Math.floor(Math.random() * 4)];
            const topic = friends[name].topics[Math.floor(Math.random() * friends[name].topics.length)];
            addMsg(name, topic, "bot");
        }
        resetAutoTimer();
    }, nextInterval);
}

function doSend() {
    const input = document.getElementById('userInput');
    const text = input.value.trim();
    if(!text) return;
    addMsg("ä½ ", text, "user");
    input.value = "";
    resetAutoTimer();
    setTimeout(() => {
        let name = config.mode === 'single' ? config.target : Object.keys(friends)[Math.floor(Math.random()*4)];
        addMsg(name, getReply(name, text), "bot");
    }, 600);
}

function getReply(name, input) {
    const data = friends[name];
    for (let key in data.keywords) {
        if (input.includes(key)) return data.keywords[key];
    }
    return data.fallbacks[Math.floor(Math.random() * data.fallbacks.length)];
}

function addMsg(sender, text, type) {
    const box = document.getElementById('messages');
    const d = document.createElement('div');
    d.className = `msg ${type}`;
    const nameHtml = type === 'bot' ? `<div class="name">${sender}</div>` : '';
    d.innerHTML = `${nameHtml}${text}`;
    box.appendChild(d);
    box.scrollTop = box.scrollHeight;
    if (type === 'bot' && sender !== "ç³»çµ±") scanForReaction(sender, text);
}
</script>
</body>
</html>