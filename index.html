<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°åº—é¡å®¶ - å®‰å®¶è»å‡ºå¾æ¨¡æ“¬å™¨</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #84a1c1; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        #setup { background: white; padding: 40px 30px; border-radius: 20px; text-align: center; box-shadow: 0 15px 35px rgba(0,0,0,0.3); width: 340px; }
        .slogan { font-size: 24px; font-weight: 900; color: #ff4d4d; margin-bottom: 20px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        #chat-container { display: none; width: 100%; max-width: 500px; height: 100vh; background: #84a1c1; flex-direction: column; }
        #status-bar { background: rgba(0,0,0,0.2); padding: 12px; color: white; font-weight: bold; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); }
        #messages { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; }
        .msg { margin-bottom: 12px; padding: 10px 14px; border-radius: 18px; font-size: 14.5px; line-height: 1.5; max-width: 80%; }
        .msg.bot { background: white; align-self: flex-start; border-top-left-radius: 2px; }
        .msg.user { background: #95ec69; align-self: flex-end; border-top-right-radius: 2px; }
        .name { font-size: 11px; color: #555; margin-bottom: 4px; font-weight: bold; }
        .input-box { background: #fff; padding: 15px; display: flex; gap: 10px; border-top: 1px solid #ddd; }
        input { flex: 1; border: 1px solid #ddd; border-radius: 25px; padding: 12px 18px; outline: none; }
        button { background: #00c300; color: white; border: none; padding: 0 22px; border-radius: 25px; cursor: pointer; font-weight: bold; }
        select { width: 100%; padding: 10px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #ccc; font-size: 14px; }
    </style>
</head>
<body>

<div id="setup">
    <div class="slogan">å”¯ä¸€æ”¯æŒå®‰å®¶è»</div>
    <p style="color: #666; font-size: 14px; margin-bottom: 25px;">ç´ æåº«ï¼šAlia / èœåˆ€å®‰ / Cartier / å˜‰æ©</p>
    <select id="mode">
        <option value="group">ğŸ”Š é€²å…¥é¡å®¶å¤§ç¾¤ (å…¨é«”äº’å™´)</option>
        <option value="single_ç†Šå‰›å‰›Jimmy">å–®èŠï¼šç†Šå‰›å‰›Jimmy (é¢¨éšªå°æ²–)</option>
        <option value="single_ç‹æ°´æº">å–®èŠï¼šç‹æ°´æº (å˜‰æ©ç„¦æ…®)</option>
        <option value="single_é»ƒå­åº­ Troy">å–®èŠï¼šé»ƒå­åº­ Troy (èœåˆ€èˆ‡Alia)</option>
        <option value="single_Gee Homie">å–®æŒ‘ï¼šGee Homie (Cartierå®¢æˆ¶)</option>
    </select>
    <button onclick="initChat()" style="width: 100%; padding: 15px; font-size: 16px;">é–‹å§‹èŠå¤©</button>
</div>

<div id="chat-container">
    <div id="status-bar">æ–°åº—é¡å®¶ (4) - å”¯ä¸€æ”¯æŒå®‰å®¶è»</div>
    <div id="messages"></div>
    <div class="input-box">
        <input type="text" id="userInput" placeholder="è¼¸å…¥é—œéµå­—ï¼šAlia, èœåˆ€å®‰, åˆ†æ‰‹..." onkeypress="if(event.keyCode==13) doSend()">
        <button onclick="doSend()">å‚³é€</button>
    </div>
</div>

<script>
const friends = {
    "ç†Šå‰›å‰›Jimmy": {
        fallbacks: ["ç¬‘æ­»", "é¢¨éšªå°æ²–æ‡‚å—", "æ­¢æå•Šå¤§å“¥", "ä¸ä¿¡ï¼Œè‚¯å®šæœ‰å¤–é‡"],
        keywords: { 
            "æ±‚å©š": "ä»–çš„æ²’é‘½å¤±æ•—ï¼Œ@Gee Homie é‘½çŸ³æ‰æ˜¯é¢¨éšªå°æ²–ï¼Œæ§“æ¡¿é–‹å¤ªå¤§æœƒç¿»è»Š",
            "çµå©š": "å¸¶å››å·åª³å©¦éƒ½ä¸ç”¨æ”¹æ©Ÿç¥¨ï¼Œçœå¤šå°‘éŒ¢ï¼Œå¦³å€‘çœŸçš„è´äº†",
            "åˆ†æ‰‹": "æˆ‘æ—©å°±èªªè¦åˆ†æ‰‹ï¼Œé¢¨éšªå°æ²–åŠ æ§“æ¡¿çš„æ¦‚å¿µï¼Œåˆ†äº†å•¦æ­¢æ",
            "èœåˆ€å®‰": "@é»ƒå­åº­ Troy å…„å¼Ÿï¼Œæ²’çœ‹åˆ°åˆ€ä¸å®‰å¿ƒï¼Œæ²’çœ‹åˆ°åˆ€ç¡¬ä¸èµ·ä¾†",
            "å˜‰æ©": "æ°´æºåˆè¦é–‹å§‹ç—›è‹¦äº†ï¼Œç¬‘æ­»åˆ°åº•è¦èŠå¹¾æ¬¡"
        },
        topics: ["ç¬‘æ­»ï¼Œç‹æ°´æºåˆè¦èŠå˜‰æ©äº†", "é»ƒå­åº­æ˜¯ä¸æ˜¯åˆè¢«èœåˆ€å®‰å¨è„…äº†", "é¢¨éšªå°æ²–ï¼Œå•å°±æ˜¯è¶Šè·Œè¶Šè²·", "åˆ†æ‰‹å•¦ï¼Œä¸åˆ†ç•™è‘—éå¹´ï¼Ÿ"]
    },
    "ç‹æ°´æº": {
        fallbacks: ["å¥½ç—›è‹¦", "æƒ³æ‰¾å€‹æ­£å¸¸äººäº¤å¾€å¥½é›£", "ç„¡è¨€", "å‡è³½å•¦"],
        keywords: { 
            "å˜‰æ©": "ç‚ºå•¥å˜‰æ©éƒ½ä¸å›æˆ‘ï¼Œä¸æ˜¯åœ¨åŒä¸€ç­æ©Ÿä¸Šå—...æˆ‘å¥½ç—›è‹¦",
            "Alia": "Aliaæ˜¯äººï¼ä½†é»ƒå­åº­ä½ é¸çš„æ±è¥¿çœŸçš„è¢«å«Œå¾—ä¸€ç„¡æ˜¯è™•ï¼Œå¹«QQ",
            "çµå©š": "æƒ³æ‰¾å€‹æ­£å¸¸äººçµå©šå¥½é›£ï¼Œæˆ‘é‚„æ˜¯æƒ³è·Ÿå˜‰æ©å»æ±äº¬ï¼Œé›–ç„¶æ”¹æœŸäº†",
            "æ±‚å©š": "çœ‹åˆ°åˆ¥äººåœ¨è¿ªå£«å°¼æ±‚å©šï¼Œæˆ‘æ”¹ä¸€ä¸‹å±¥æ­·ï¼Œæ”¹æˆåœ¨å¾®é¢¨æ±‚å©šå¥½äº†",
            "åˆ†æ‰‹": "åˆ†æ‰‹å¥½ç—›è‹¦ï¼Œä½†æˆ‘å·²ç¶“æ²’æœ‰äº‚æçš„æœ¬éŒ¢äº†ï¼Œäº”å‘³é›œé™³"
        },
        topics: ["æˆ‘å¥½ç—›è‹¦ï¼Œå˜‰æ©é€™å¥³äººçœŸçš„æ²’æ•‘", "Aliaæ˜¯äººï¼Œä¸æ˜¯å¤–å‹", "æ‰¾å€‹æ­£å¸¸äººçµå©šé‚£éº¼é›£å—", "æ±‚å©šæ˜¯ä¸æ˜¯è¦çœ‹ç…™ç«"]
    },
    "é»ƒå­åº­ Troy": {
        fallbacks: ["ç™½ç™¡å–”", "æœ‰äººåœ¨ä¹æˆ‘çš„æ„Ÿå—å—", "ç´°ç‹—", "æ“ä½ åª½"],
        keywords: { 
            "Alia": "Alia å«Œæˆ‘é¸çš„æ±è¥¿ä¸€ç„¡æ˜¯è™•...æˆ‘å¥½é›£éï¼Œæœ‰äººåœ¨ä¹æˆ‘çš„æ„Ÿå—å—ï¼Ÿ",
            "èœåˆ€å®‰": "å”¯ä¸€æ”¯æŒèœåˆ€å®‰ğŸ”ªğŸ”ªğŸ”ªï¼æ²’çœ‹åˆ°åˆ€ç¡¬ä¸èµ·ä¾†",
            "æ±‚å©š": "å¤ç®æˆ‘å°±ä¸æ’’é€™å€‹è¬Šäº†ï¼Œåæ­£è¬›äº†ä½ å€‘ä¹Ÿä¸æœƒä¿¡ï¼ŒCartierå»æ­»",
            "åˆ†æ‰‹": "çœŸçš„åˆ†äº†å•¦ï¼Œä»¥åœ–ç‚ºè­‰ï¼å›å»åˆè¦å‘¨æ—‹åˆ°æ—©ä¸Š7é»äº†",
            "çµå©š": "å˜´ä¸Šèªªè¦çµå©šï¼Œé‚„æ˜¯ä¸€ç›´äº‚æ...é€™å°±æ˜¯æˆ‘å€‘ï¼Œæ‡‚ï¼Ÿ"
        },
        topics: ["Aliaç‚ºä»€éº¼è¦å«Œæˆ‘çš„å“å‘³", "æ²’çœ‹åˆ°èœåˆ€å®‰çœŸçš„ç¡¬ä¸èµ·ä¾†", "ç‚ºä»€éº¼åªæœ‰æˆ‘æ˜¯å±€å¤–äºº", "æ“ä½ åª½æ©Ÿç¥¨æ”¹ä¾†æ”¹å»"]
    },
    "Gee Homie": {
        fallbacks: ["æ„›äº†", "ä¸‰å°å•¦", "è¡Œ", "æˆ‘ä¸ä¿¡"],
        keywords: { 
            "Cartier": "ä»–çš„æ±‚å©šæ²’æœ‰é‘½ï¼Œå¤±æ•—ã€‚æˆ‘ç¾åœ¨æ˜¯Cartierçš„å®¢æˆ¶äº†ï¼Œæ‡‚ï¼Ÿ",
            "æ±‚å©š": "æ±‚å©šè¦å˜›å°±æ˜¯ Cartierï¼Œè¦å˜›å°±æ˜¯ä¸è¦...å«‚å­å¯¦ç¿’ç•¶è¾£åª½è¦å¿«",
            "åˆ†æ‰‹": "åˆ†æ‰‹ï¼Ÿé€™æ˜¯é€šçŸ¥ä¸æ˜¯å•†é‡ï¼Œæ‡‚ï¼Ÿæ˜å¤©æ™šä¸Šé›†åˆå–åˆ†æ‰‹é…’",
            "Alia": "ä¸è¦æˆ€æˆ°ï¼ŒéŸ“åœ‹æœ‰åª³å©¦åœ¨ç­‰ä½ ï¼ŒAliaçœŸçš„åˆ†äº†å—ï¼Ÿæˆ‘ä¸ä¿¡",
            "èœåˆ€å®‰": "èœåˆ€å®‰ç›´æ¥å† è»ï¼Œå¸¶æ°å‰å» Halloween å°±å°äº†"
        },
        topics: ["Cartier å®¢æˆ¶å°±æ˜¯é«˜ç´š", "é€™æ˜¯é€šçŸ¥ä¸æ˜¯å•†é‡ï¼Œæˆ‘è¦çµå©š", "å¤–é‡ä¸‰å°å•¦", "æˆ‘ä¸ä¿¡"]
    }
};

let lastSender = "";
let autoTimer = null;
let config = { mode: 'group', target: null };

function initChat() {
    const val = document.getElementById('mode').value;
    config.mode = val === 'group' ? 'group' : 'single';
    if(config.mode === 'single') config.target = val.replace('single_', '');
    
    document.getElementById('setup').style.display = 'none';
    document.getElementById('chat-container').style.display = 'flex';
    addMsg("ç³»çµ±", "é€£ç·šæˆåŠŸã€‚å”¯ä¸€æ”¯æŒå®‰å®¶è»ï¼è©±é¡Œç´ æå·²è§£é–ã€‚", "bot");
    resetAutoTimer();
}

function getNextResponder(excludeName) {
    const names = Object.keys(friends).filter(name => name !== excludeName);
    return names[Math.floor(Math.random() * names.length)];
}

async function handleReaction(sender, text) {
    const delay = (ms) => new Promise(res => setTimeout(res, ms));
    if (config.mode !== 'group') return;

    for (let name in friends) {
        if (name === sender) continue;
        for (let key in friends[name].keywords) {
            if (text.includes(key)) {
                if (Math.random() < 0.9) {
                    await delay(800 + Math.random() * 1200);
                    addMsg(name, friends[name].keywords[key], "bot");
                    return;
                }
            }
        }
    }
}

function resetAutoTimer() {
    if(autoTimer) clearTimeout(autoTimer);
    if(config.mode !== 'group') return;
    const nextInterval = 6000 + Math.floor(Math.random() * 8000);
    autoTimer = setTimeout(() => {
        const name = getNextResponder(lastSender);
        const topic = friends[name].topics[Math.floor(Math.random() * friends[name].topics.length)];
        addMsg(name, topic, "bot");
        resetAutoTimer();
    }, nextInterval);
}

function doSend() {
    const input = document.getElementById('userInput');
    const text = input.value.trim();
    if(!text) return;

    addMsg("ä½ ", text, "user");
    input.value = "";
    resetAutoTimer();

    const responder = config.mode === 'single' ? config.target : getNextResponder("");
    setTimeout(() => {
        addMsg(responder, getReply(responder, text), "bot");
    }, 600);
}

function getReply(name, input) {
    const data = friends[name];
    for (let key in data.keywords) {
        if (input.includes(key)) return data.keywords[key];
    }
    return data.fallbacks[Math.floor(Math.random() * data.fallbacks.length)];
}

function addMsg(sender, text, type) {
    const box = document.getElementById('messages');
    const d = document.createElement('div');
    d.className = `msg ${type}`;
    const nameHtml = type === 'bot' ? `<div class="name">${sender}</div>` : '';
    d.innerHTML = `${nameHtml}${text}`;
    box.appendChild(d);
    box.scrollTop = box.scrollHeight;
    if (type === 'bot' && sender !== "ç³»çµ±") {
        lastSender = sender;
        handleReaction(sender, text);
    } else { lastSender = "User"; }
}
</script>
</body>
</html>